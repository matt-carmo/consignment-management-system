generator client {
  provider = "prisma-client-js"

}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id          String         @id @default(uuid())
  email       String         @unique
  password    String
  name        String?
  createdAt   DateTime       @default(now())
  updatedAt   DateTime       @updatedAt

  products        Product[]
  consignments    Consignment[]
}

model Product {
  id          Int       @id @default(autoincrement())
  name        String
  price       Decimal    @db.Decimal(10, 2)
  description String?
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt

  userId      String
  user        User        @relation(fields: [userId], references: [id])


  consignmentOrderItems ConsignmentOrderItem[]
}

model Consignment {
  id          String          @id @default(uuid())
  idx         Int             @unique @default(autoincrement()) // Ãºtil para busca simples
  name        String
  phone_number String
  createdAt   DateTime        @default(now())
  updatedAt   DateTime        @updatedAt
  userId      String
  user        User            @relation(fields: [userId], references: [id])
  consignmentOrders ConsignmentOrder[]
}

model ConsignmentOrder {
  id            Int               @id @default(autoincrement())
  consignmentId String
  createdAt     DateTime          @default(now())
  updatedAt     DateTime          @updatedAt
  paid          Boolean           @default(false)
  paidValue     Decimal?           @db.Decimal(10, 2)
  paidAt        DateTime?
  consignment   Consignment       @relation(fields: [consignmentId], references: [id], onDelete: NoAction)
  consignmentOrderItems ConsignmentOrderItem[]
}

model ConsignmentOrderItem {
  id                 Int               @id @default(autoincrement())
  consignmentOrderId Int
  itemId             Int
  quantity           Int               @default(0)
  itemPrice          Decimal           @db.Decimal(10, 2)
  item               Product           @relation(fields: [itemId], references: [id])
  consignmentOrder   ConsignmentOrder   @relation(fields: [consignmentOrderId], references: [id])
}

